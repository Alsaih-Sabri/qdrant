#@ load("openapi.lib.yml", "response", "reference", "type", "array")

paths:
  /telemetry:
    get:
      summary: Collect telemetry data
      description: Collect telemetry data including app info, system info, collections info, cluster info, configs and statistics
      operationId: telemetry
      tags:
        - service
      parameters:
        - name: anonymize
          in: query
          description: "If true, anonymize result"
          required: false
          schema:
            type: boolean
      responses: #@ response(array(reference("TelemetryData")))

  /write_lock:
    put:
      summary: Lock writing
      description: Lock writing. If locked, all write operations and collections creation are forbidden. Returns previous lock value
      operationId: put_write_lock
      tags:
        - service
      requestBody:
        description: Optional error message
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/WriteLockOptions"
      responses: #@ response(type("boolean"))

    get:
      summary: Check if writing is locked
      description:  Check if writing is locked. If locked, all write operations and collections creation are forbidden
      operationId: get_write_lock
      tags:
        - service
      responses: #@ response(type("boolean"))

  /write_unlock:
    put:
      summary: Unlock writing
      description: Unlock writing. If locked, all write operations and collections creation are forbidden. Returns previous lock value
      operationId: put_write_unlock
      tags:
        - service
      responses: #@ response(type("boolean"))

    get:
      summary: Check if writing is unlocked
      description:  Check if writing is unlocked. If locked, all write operations and collections creation are forbidden
      operationId: get_write_unlock
      tags:
        - service
      responses: #@ response(type("boolean"))
